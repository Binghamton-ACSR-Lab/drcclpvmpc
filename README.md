# DRCC-LPVMPC: Robust Data-Driven Control for Autonomous Driving and Obstacle Avoidance

The DRCC-LPVMPC framework integrates distributionally robust chance constraints into a linear parameter-varying model predictive control (LPVMPC) formulation. By leveraging a data-driven ambiguity set constructed from empirical disturbances, the controller achieves real-time robust control under model and sensor uncertainties, ensuring safety and recursive feasibility in dynamic autonomous driving scenarios.
This repository provides the source code for the control framework presented in: S. Fang, X. Li, C. Wu, and K. Yu (2025). “DRCC-LPVMPC: Robust Data-Driven Control for Autonomous Driving and Obstacle Avoidance.” Submitted to IEEE Transactions on Control Systems Technology, under review.

## Supplementary Video
This video provides supplementary material for the paper and demonstrates the proposed DRCC-LPVMPC framework through:

- Numerical simulations: Static and moving obstacles, with and without disturbances, compared with LPVMPC.
- CARLA simulations: Autonomous driving scenarios in high-fidelity CARLA with real-time perception in ROS 2.
- Real-world experiments: Tests on a 1:5 scaled vehicle, compared with LPVMPC.

https://github.com/user-attachments/assets/fd6a4548-4671-49ab-a2e4-55e06d203cdd

This simulation is supporting Python3.12, please refer to ``python312`` branch if interested.

## Installation

It is recommended to create a new virtual environment, we recommend user to use [Miniforge](https://github.com/conda-forge/miniforge) to create virtual environment:It is recommended to create a new conda environment:

```
conda create --name drcc_lpvmpc python=3.8.19
conda activate drcc_lpvmpc
```

To install drcc_lpvmpc:

```
git clone https://github.com/Heliosfang/drcc_lpvmpc.git
cd drcc_lpvmpc/
pip install -e .
```

## Run drcc_lpvmpc

```
cd drcc_lpvmpc
cd main
python drcc_lpvmpc_main.py
```

## Modify the main file

First, refer to the main/config/config.yaml

Change useDRCC to False and then run the main file again, this will lead to control the vehicle with pure quasi-lpvmpc controller.
Change add_disturbance to True and then run the main file again, this will add additive random noise to the vehicle location which simulate the disturbance from other factors e.g. localizations, sensors, etc.

## Simulation use DRCC-LPVMPC (No Extra Disturbances)

Simulation environment use ETHZ from [MPCC](https://github.com/alexliniger/MPCC), where only raceline is used, tracking reference is generated by a least time optimization process.

No random disturbances are added to the states of the vehicle:

https://github.com/user-attachments/assets/3fc0925b-4531-49d8-b646-8035060de683

## Simulation use DRCC-LPVMPC (Extra Random Disturbances added)

Random disturbances are added to the states of the vehicle at each steps:

https://github.com/user-attachments/assets/0c8794ac-ff24-434f-bd14-65213d8e666d

## ROS2 Package with Simulation in CARLA

[ROS2 package](https://github.com/Heliosfang/ros2_ws) is also provide with carla simulation demo.



